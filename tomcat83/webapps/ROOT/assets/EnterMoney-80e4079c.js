import{a as V}from"./index-056fe9eb.js";import{t as N,s as C,v as $,x as H,y as p,z as t,A as u,O as c,R as q,S as b,M as P,N as E,P as U,G as d,H as k,T as _,h as z,I as Q,Q as j}from"./index-4e4cc9b7.js";import{_ as G,a as K,b as L,c as O}from"./Spin-2deb43aa.js";import{_ as J}from"./DatePicker-896a5640.js";import"./get-slot-1efb97e5.js";const W={class:"bgd-page"},X={class:"search-box"},Y={class:"data-statistics"},Z={class:"grid-content"},ee={class:"grid-content"},te={class:"grid-content"},ae={class:"grid-content"},le={class:"grid-content"},re={__name:"EnterMoney",setup(ne){const I=N([{title:"订单号",key:"id",width:100},{title:"下游订单号",key:"orderId"},{title:"第三方订单号",key:"transactionNum"},{title:"金额",key:"amount"},{title:"商户手续费",key:"platformFee"},{title:"充值类型",key:"type",width:100},{title:"订单状态",key:"status",render:a=>z(_,{style:{marginRight:"6px"},type:a.status==="成功"?"success":"warning",bordered:!1},{default:()=>a.status})},{title:"实际状态",key:"status1",render:a=>z(_,{style:{marginRight:"6px"},type:a.status1==="成功"?"success":"warning",bordered:!1},{default:()=>a.status1})},{title:"回调状态",key:"syncCnt",width:100},{title:"创建时间",key:"createTime",width:160,render:a=>a.createTime?a.createTime:"-"},{title:"支付时间",key:"payTime",width:160,render:a=>a.payTime?a.payTime:"-"}]),w=N(!0),F=N(0),S=a=>a.id,r=N(null),i=C({needPayAmount:0,payAmount:0,payFee:0,payNum:0,rate:"0%"}),e=C({id:null,appId:null,orderId:null,transactionNum:null,payTypeId:null,type:null,status:"1",status1:null,syncCnt:null,country:null,clabe:null,rastreo:null,amount:null,page:1,limit:10,rowindex:0}),A=N([]),g=async()=>{e.startCreateTime=r.value?r.value[0]:"",e.endCreateTime=r.value?r.value[1]:"",w.value=!0;const a=await V(e);A.value=a.data.list.map(n=>{n.type=q(n),n.amount=b(n.amount),n.platformFee=b(n.platformFee),n.thirdFee=b(n.thirdFee);let f=n.status;f=f===1?"成功":f===0?"待处理":"失败",n.status=f;let y=n.status1;y=y===1?"成功":y===0?"待处理":"失败",n.status1=y;let s=n.syncCnt;s=s===1?"同步成功":s===0?"未回调":"同步失败"+s*-1+"次",n.syncCnt=s;let x=n.validStatus;return x=x===1?"已结算":"未结算",n.validStatus=x,n.createTime=P(n.createTime),n.payTime=P(n.payTime),n});const l=a.data.statistics;console.log("入款管理",a);var m=l.needPayAmount,o=l.payAmount,v=l.payFee,T=l.payNum,h=l.allPayNum;m!==null&&(i.needPayAmount=b(m)),o!==null&&(i.payAmount=b(o)),v!==null&&(i.payFee=b(v)),i.payNum=T,Number(h)!==0?i.rate=Math.floor(Number(T)/Number(h)*100).toFixed(2)+"%":i.rate="总单数为0",F.value=a.data.statistics.allPayNum,w.value=!1},M=a=>{e.page=a,g()},B=a=>{e.size=a,e.page=1,g()};function D(){for(const a in e)e[a]=null;r.value=null,e.page=1,e.limit=10,e.rowIndex=0,g()}function R(){e.page=1,e.limit=10,e.rowIndex=0,g()}return g(),(a,l)=>{const m=Q,o=j,v=K,T=J,h=E,n=L,f=O,y=G;return $(),H("div",W,[p("div",X,[t(h,{ref:"formRef","label-width":90,model:e,inline:"",class:"search-form",size:"medium","label-placement":"left"},{default:u(()=>[t(o,{label:"系统订单号"},{default:u(()=>[t(m,{value:e.id,"onUpdate:value":l[0]||(l[0]=s=>e.id=s),placeholder:"系统订单号"},null,8,["value"])]),_:1}),t(o,{label:"商户订单号"},{default:u(()=>[t(m,{value:e.orderId,"onUpdate:value":l[1]||(l[1]=s=>e.orderId=s),placeholder:"商户订单号"},null,8,["value"])]),_:1}),t(o,{label:"三方订单号"},{default:u(()=>[t(m,{value:e.transactionNum,"onUpdate:value":l[2]||(l[2]=s=>e.transactionNum=s),placeholder:"三方订单号"},null,8,["value"])]),_:1}),t(o,{label:"订单状态"},{default:u(()=>[t(v,{value:e.status,"onUpdate:value":l[3]||(l[3]=s=>e.status=s),options:[{label:"成功",value:"1"},{label:"待处理",value:"0"},{label:"失败",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(o,{label:"实际状态"},{default:u(()=>[t(v,{value:e.status1,"onUpdate:value":l[4]||(l[4]=s=>e.status1=s),options:[{label:"成功",value:"1"},{label:"待处理",value:"0"},{label:"失败",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(o,{label:"同步状态"},{default:u(()=>[t(v,{value:e.syncCnt,"onUpdate:value":l[5]||(l[5]=s=>e.syncCnt=s),options:[{label:"同步成功",value:"1"},{label:"未回调",value:"0"},{label:"失败重试",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(o,{label:"金额"},{default:u(()=>[t(m,{value:e.amount,"onUpdate:value":l[6]||(l[6]=s=>e.amount=s),placeholder:"金额"},null,8,["value"])]),_:1}),t(o,{label:"起止时间"},{default:u(()=>[t(T,{"formatted-value":r.value,"onUpdate:formattedValue":l[7]||(l[7]=s=>r.value=s),type:"datetimerange",clearable:"","value-format":"yyyy-MM-dd HH:mm:ss",style:{width:"300px"}},null,8,["formatted-value"])]),_:1}),t(o,{label:""},{default:u(()=>[t(c(U),{size:"medium",style:{"margin-right":"10px"},onClick:D},{default:u(()=>[d("清空")]),_:1}),t(c(U),{size:"medium",type:"info",onClick:R},{default:u(()=>[d("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),p("div",Y,[p("div",Z,[t(c(_),{type:"success"},{default:u(()=>[d("订单总额："+k(i.needPayAmount),1)]),_:1})]),p("div",ee,[t(c(_),{type:"success"},{default:u(()=>[d("实收订单总额："+k(i.payAmount),1)]),_:1})]),p("div",te,[t(c(_),{type:"success"},{default:u(()=>[d("实收手续费："+k(i.payFee),1)]),_:1})]),p("div",ae,[t(c(_),{type:"success"},{default:u(()=>[d("实收订单数："+k(i.payNum),1)]),_:1})]),p("div",le,[t(c(_),{type:"success"},{default:u(()=>[d("成功率："+k(i.rate),1)]),_:1})])]),t(y,{show:w.value},{description:u(()=>[d("加载中...")]),default:u(()=>[t(n,{columns:I.value,data:A.value,"row-key":S,"single-line":!1,id:"dataTable"},null,8,["columns","data"]),t(f,{style:{margin:"18px 0"},"show-size-picker":"","show-quick-jumper":"","page-sizes":[10,20,50,100],page:e.page,"onUpdate:page":[l[8]||(l[8]=s=>e.page=s),M],"page-count":F.value,"onUpdate:pageSize":B},null,8,["page","page-count"])]),_:1},8,["show"])])}}};export{re as default};
