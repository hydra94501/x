import{a as V}from"./index-b24cc282.js";import{t as N,s as A,v as $,x as H,y as c,z as t,A as u,O as p,R as q,S as b,M as C,N as E,P,G as r,H as k,T as _,h as U,I as Q,Q as j}from"./index-e129a366.js";import{_ as G,a as K,b as L,c as O}from"./Spin-2f5a88f8.js";import{_ as J}from"./DatePicker-3df33e66.js";import"./get-slot-1efb97e5.js";const W={class:"bgd-page"},X={class:"search-box"},Y={class:"data-statistics"},Z={class:"grid-content"},ee={class:"grid-content"},te={class:"grid-content"},ae={class:"grid-content"},le={class:"grid-content"},de={__name:"EnterMoney",setup(ne){const I=N([{title:"订单号",key:"id",width:100,resizable:!0},{title:"下游订单号",key:"orderId",width:210,resizable:!0},{title:"第三方订单号",key:"transactionNum",width:210,resizable:!0},{title:"金额",key:"amount"},{title:"商户手续费",key:"platformFee"},{title:"充值类型",key:"type",width:100,resizable:!0},{title:"订单状态",key:"status",render:a=>U(_,{style:{marginRight:"6px"},type:a.status==="成功"?"success":"warning",bordered:!1},{default:()=>a.status})},{title:"实际状态",key:"status1",render:a=>U(_,{style:{marginRight:"6px"},type:a.status1==="成功"?"success":"warning",bordered:!1},{default:()=>a.status1})},{title:"回调状态",key:"syncCnt",width:100,resizable:!0},{title:"创建时间",key:"createTime",width:160,resizable:!0,render:a=>a.createTime?a.createTime:"-"},{title:"支付时间",key:"payTime",width:160,resizable:!0,render:a=>a.payTime?a.payTime:"-"}]),T=N(!0),z=N(0),S=a=>a.id,d=N(null),o=A({needPayAmount:0,payAmount:0,payFee:0,payNum:0,rate:"0%"}),e=A({id:null,appId:null,orderId:null,transactionNum:null,payTypeId:null,type:null,status:"1",status1:null,syncCnt:null,country:null,clabe:null,rastreo:null,amount:null,page:1,limit:10,rowindex:0}),F=N([]),g=async()=>{e.startCreateTime=d.value?d.value[0]:"",e.endCreateTime=d.value?d.value[1]:"",T.value=!0;const a=await V(e);F.value=a.data.list.map(n=>{n.type=q(n),n.amount=b(n.amount),n.platformFee=b(n.platformFee),n.thirdFee=b(n.thirdFee);let f=n.status;f=f===1?"成功":f===0?"待处理":"失败",n.status=f;let y=n.status1;y=y===1?"成功":y===0?"待处理":"失败",n.status1=y;let s=n.syncCnt;s=s===1?"同步成功":s===0?"未回调":"同步失败"+s*-1+"次",n.syncCnt=s;let x=n.validStatus;return x=x===1?"已结算":"未结算",n.validStatus=x,n.createTime=C(n.createTime),n.payTime=C(n.payTime),n});const l=a.data.statistics;console.log("入款管理",a);var m=l.needPayAmount,i=l.payAmount,v=l.payFee,h=l.payNum,w=l.allPayNum;m!==null&&(o.needPayAmount=b(m)),i!==null&&(o.payAmount=b(i)),v!==null&&(o.payFee=b(v)),o.payNum=h,Number(w)!==0?o.rate=Math.floor(Number(h)/Number(w)*100).toFixed(2)+"%":o.rate="总单数为0",z.value=a.data.statistics.allPayNum,T.value=!1},M=a=>{e.page=a,g()},B=a=>{e.limit=a,e.page=1,g()};function D(){for(const a in e)e[a]=null;d.value=null,e.page=1,e.limit=10,e.rowIndex=0,g()}function R(){e.page=1,e.limit=10,e.rowIndex=0,g()}return g(),(a,l)=>{const m=Q,i=j,v=K,h=J,w=E,n=L,f=O,y=G;return $(),H("div",W,[c("div",X,[t(w,{ref:"formRef","label-width":90,model:e,inline:"",class:"search-form",size:"medium","label-placement":"left"},{default:u(()=>[t(i,{label:"系统订单号"},{default:u(()=>[t(m,{value:e.id,"onUpdate:value":l[0]||(l[0]=s=>e.id=s),placeholder:"系统订单号"},null,8,["value"])]),_:1}),t(i,{label:"商户订单号"},{default:u(()=>[t(m,{value:e.orderId,"onUpdate:value":l[1]||(l[1]=s=>e.orderId=s),placeholder:"商户订单号"},null,8,["value"])]),_:1}),t(i,{label:"三方订单号"},{default:u(()=>[t(m,{value:e.transactionNum,"onUpdate:value":l[2]||(l[2]=s=>e.transactionNum=s),placeholder:"三方订单号"},null,8,["value"])]),_:1}),t(i,{label:"订单状态"},{default:u(()=>[t(v,{value:e.status,"onUpdate:value":l[3]||(l[3]=s=>e.status=s),options:[{label:"成功",value:"1"},{label:"待处理",value:"0"},{label:"失败",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(i,{label:"实际状态"},{default:u(()=>[t(v,{value:e.status1,"onUpdate:value":l[4]||(l[4]=s=>e.status1=s),options:[{label:"成功",value:"1"},{label:"待处理",value:"0"},{label:"失败",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(i,{label:"同步状态"},{default:u(()=>[t(v,{value:e.syncCnt,"onUpdate:value":l[5]||(l[5]=s=>e.syncCnt=s),options:[{label:"同步成功",value:"1"},{label:"未回调",value:"0"},{label:"失败重试",value:"-1"}],"value-field":"value","label-field":"label"},null,8,["value"])]),_:1}),t(i,{label:"金额"},{default:u(()=>[t(m,{value:e.amount,"onUpdate:value":l[6]||(l[6]=s=>e.amount=s),placeholder:"金额"},null,8,["value"])]),_:1}),t(i,{label:"起止时间"},{default:u(()=>[t(h,{"formatted-value":d.value,"onUpdate:formattedValue":l[7]||(l[7]=s=>d.value=s),type:"datetimerange",clearable:"","value-format":"yyyy-MM-dd HH:mm:ss",style:{width:"300px"}},null,8,["formatted-value"])]),_:1}),t(i,{label:""},{default:u(()=>[t(p(P),{size:"medium",style:{"margin-right":"10px"},onClick:D},{default:u(()=>[r("清空")]),_:1}),t(p(P),{size:"medium",type:"info",onClick:R},{default:u(()=>[r("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),c("div",Y,[c("div",Z,[t(p(_),{type:"success"},{default:u(()=>[r("订单总额："+k(o.needPayAmount),1)]),_:1})]),c("div",ee,[t(p(_),{type:"success"},{default:u(()=>[r("实收订单总额："+k(o.payAmount),1)]),_:1})]),c("div",te,[t(p(_),{type:"success"},{default:u(()=>[r("实收手续费："+k(o.payFee),1)]),_:1})]),c("div",ae,[t(p(_),{type:"success"},{default:u(()=>[r("实收订单数："+k(o.payNum),1)]),_:1})]),c("div",le,[t(p(_),{type:"success"},{default:u(()=>[r("成功率："+k(o.rate),1)]),_:1})])]),t(y,{show:T.value},{description:u(()=>[r("加载中...")]),default:u(()=>[t(n,{columns:I.value,data:F.value,"row-key":S,"single-line":!1,id:"dataTable","scroll-x":1600},null,8,["columns","data"]),t(f,{style:{margin:"18px 0"},"show-size-picker":"","show-quick-jumper":"","page-sizes":[10,20,50,100],page:e.page,"onUpdate:page":[l[8]||(l[8]=s=>e.page=s),M],"page-count":z.value,"onUpdate:pageSize":B},null,8,["page","page-count"])]),_:1},8,["show"])])}}};export{de as default};
